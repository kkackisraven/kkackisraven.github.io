<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>SEORAB - MOBILE EDITOR</title>
    <style>
        body { background-color: #222; margin: 0; width: 100vw; height: 100vh; overflow: hidden; display: flex; }
        
        /* ì™¼ìª½ ì •ë³´ì°½ */
        #info-panel {
            width: 350px; background: #111; color: #ccc; padding: 20px; font-family: monospace;
            z-index: 99999; border-right: 1px solid #444; overflow-y: auto; display: flex; flex-direction: column;
        }
        #info-panel h3 { margin-top: 0; color: cyan; }
        textarea { width: 100%; height: 300px; background: #000; color: #0f0; border: 1px solid #555; font-size: 12px; flex-grow: 1; margin-bottom: 10px; }
        button { width:100%; padding:15px; cursor:pointer; background:cyan; border:none; font-weight:bold; font-size: 16px; color: black;}

        /* ë¬´ëŒ€ (ëª¨ë°”ì¼ ë¹„ìœ¨) */
        #stage-container { flex-grow: 1; display: flex; justify-content: center; align-items: center; background: #333; padding: 20px; }
        
        #mobile-stage {
            position: relative;
            height: 90vh; /* í™”ë©´ ë†’ì´ì˜ 90% */
            aspect-ratio: 9 / 19.5; /* ì•„ì´í° ë¹„ìœ¨ */
            background-color: #fff; 
            border: 5px solid yellow; /* ëª¨ë°”ì¼ í™”ë©´ ê²½ê³„ì„  */
            box-shadow: 0 0 30px rgba(0,0,0,0.5);
        }

        /* ì´ë¯¸ì§€ ê³µí†µ */
        .m-layer { 
            position: absolute; top: 0; left: 0; width: 100%; height: 100%; 
            object-fit: contain; pointer-events: none; opacity: 0.5; /* ìœ„ì¹˜ ì¡ê¸° í¸í•˜ê²Œ ë°˜íˆ¬ëª… */
        }
        
        /* ë°°ê²½ì€ ì„ ëª…í•˜ê²Œ */
        #m-bg { opacity: 1; z-index: 1; }
        
        /* ê°€êµ¬ë“¤ (ìœ„ì¹˜ ì¡ì„ ëŒ€ìƒ) */
        .furniture { z-index: 10; opacity: 0.8; }

        /* ë“œë˜ê·¸ ë°•ìŠ¤ */
        .click-zone {
            position: absolute;
            z-index: 1000;
            background-color: rgba(255, 0, 0, 0.3);
            border: 2px solid red;
            cursor: move;
            resize: both;
            overflow: hidden;
            min-width: 20px; min-height: 20px;
        }
        .click-zone::after {
            content: attr(data-name);
            color: white; font-size: 12px; font-weight:bold;
            padding: 2px; display: block; background: rgba(0,0,0,0.7); 
            white-space: nowrap;
        }
        .click-zone.active { border: 2px solid cyan; background-color: rgba(0, 255, 255, 0.3); z-index: 1001; }

        /* ì´ˆê¸° ìœ„ì¹˜ (ëŒ€ì¶© ë¿Œë ¤ë‘ ) */
        #zone-switch { top: 10%; left: 10%; width: 15%; height: 5%; }
        #zone-drawer { top: 20%; left: 10%; width: 30%; height: 20%; }
        #zone-cabinet { top: 20%; left: 50%; width: 30%; height: 20%; }
        #zone-poster { top: 50%; left: 10%; width: 30%; height: 20%; }
        #zone-schedule { top: 50%; left: 50%; width: 30%; height: 20%; }

    </style>
</head>
<body>

    <div id="info-panel">
        <h3>ğŸ“± ëª¨ë°”ì¼ ê³µì‚¬íŒ</h3>
        <p>
            1. <strong>ë¹¨ê°„ ë°•ìŠ¤</strong>ë¥¼ ë“œë˜ê·¸í•´ì„œ ê° ê°€êµ¬ ìœ„ì¹˜ì— ë§ì¶”ì„¸ìš”.<br>
            2. ë°•ìŠ¤ ì˜¤ë¥¸ìª½ ì•„ë˜ë¥¼ ì¡ìœ¼ë©´ <strong>í¬ê¸° ì¡°ì ˆ</strong>ë„ ë©ë‹ˆë‹¤.<br>
            3. ë‹¤ ë§ì¶”ë©´ ì•„ë˜ ë²„íŠ¼ í´ë¦­!
        </p>
        <textarea id="result-code" readonly>ìœ„ì¹˜ë¥¼ ì¡ê³  ë²„íŠ¼ì„ ëˆ„ë¥´ì„¸ìš”.</textarea>
        <button onclick="updateCoords()">ì¢Œí‘œ ì¶”ì¶œí•˜ê¸°</button>
    </div>

    <div id="stage-container">
        <div id="mobile-stage">
            <img src="m_bg.png?v=edit" class="m-layer" id="m-bg">

            <img src="m_switch_on.png?v=edit" class="m-layer furniture">
            <img src="m_drawer_default.png?v=edit" class="m-layer furniture">
            <img src="m_cabinet_default.png?v=edit" class="m-layer furniture">
            <img src="m_poster.png?v=edit" class="m-layer furniture">
            <img src="m_schedule.png?v=edit" class="m-layer furniture">
            
            <div class="click-zone" id="zone-switch" data-name="ìŠ¤ìœ„ì¹˜"></div>
            <div class="click-zone" id="zone-drawer" data-name="ì™¼ìª½ ì„œë"></div>
            <div class="click-zone" id="zone-cabinet" data-name="ì˜¤ë¥¸ìª½ ìºë¹„ë‹›"></div>
            <div class="click-zone" id="zone-poster" data-name="í¬ìŠ¤í„°"></div>
            <div class="click-zone" id="zone-schedule" data-name="ì¼ì •í‘œ"></div>
        </div>
    </div>

    <script>
        const zones = document.querySelectorAll('.click-zone');
        let activeItem = null;
        let startX, startY, startLeft, startTop;

        zones.forEach(zone => {
            zone.addEventListener('mousedown', dragStart);
            // ëª¨ë°”ì¼ í„°ì¹˜ ì§€ì› (í°ìœ¼ë¡œ ìœ„ì¹˜ ì¡ì„ ìˆ˜ë„ ìˆìœ¼ë‹ˆê¹Œ)
            zone.addEventListener('touchstart', dragStart, {passive: false});
        });

        function dragStart(e) {
            if (e.type === 'mousedown' && e.offsetX > e.target.clientWidth - 15 && e.offsetY > e.target.clientHeight - 15) return;
            
            const evt = e.type === 'touchstart' ? e.touches[0] : e;
            
            zones.forEach(z => z.classList.remove('active'));
            e.target.classList.add('active');
            activeItem = e.target;
            startX = evt.clientX;
            startY = evt.clientY;
            startLeft = activeItem.offsetLeft;
            startTop = activeItem.offsetTop;
            
            if (e.type === 'touchstart') {
                document.addEventListener('touchmove', dragMove, {passive: false});
                document.addEventListener('touchend', dragEnd);
            } else {
                document.addEventListener('mousemove', dragMove);
                document.addEventListener('mouseup', dragEnd);
            }
        }

        function dragMove(e) {
            if (!activeItem) return;
            if (e.preventDefault) e.preventDefault();
            
            const evt = e.type === 'touchmove' ? e.touches[0] : e;
            const dx = evt.clientX - startX;
            const dy = evt.clientY - startY;
            const parent = activeItem.parentElement;

            const newLeft = ((startLeft + dx) / parent.clientWidth) * 100;
            const newTop = ((startTop + dy) / parent.clientHeight) * 100;

            activeItem.style.left = newLeft + "%";
            activeItem.style.top = newTop + "%";
        }

        function dragEnd() {
            activeItem = null;
            document.removeEventListener('mousemove', dragMove);
            document.removeEventListener('mouseup', dragEnd);
            document.removeEventListener('touchmove', dragMove);
            document.removeEventListener('touchend', dragEnd);
        }

        function updateCoords() {
            const stage = document.getElementById('mobile-stage');
            let result = "/* ëª¨ë°”ì¼ ì¢Œí‘œ (ë³µì‚¬í•´ì„œ ì£¼ì„¸ìš”) */\n";
            
            zones.forEach(zone => {
                let t = (zone.offsetTop / stage.clientHeight * 100).toFixed(2);
                let l = (zone.offsetLeft / stage.clientWidth * 100).toFixed(2);
                let w = (zone.offsetWidth / stage.clientWidth * 100).toFixed(2);
                let h = (zone.offsetHeight / stage.clientHeight * 100).toFixed(2);
                
                // ëª¨ë°”ì¼ìš© IDì—ëŠ” 'm-' ì ‘ë‘ì‚¬ë¥¼ ë¶™ì—¬ì„œ êµ¬ë¶„í•  ê²ë‹ˆë‹¤
                result += `#mobile-${zone.id.replace('zone-', '')} { top: ${t}%; left: ${l}%; width: ${w}%; height: ${h}%; }\n`;
            });
            
            const textarea = document.getElementById('result-code');
            textarea.value = result;
            textarea.select();
        }
    </script>
</body>
</html>
